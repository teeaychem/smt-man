if (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
  message("Adding homebrew to cmake prefix path")
  set(HOMEBREW_PREFIX "/opt/homebrew")
  set(CMAKE_PREFIX_PATH "${HOMEBREW_PREFIX}")
endif()

# Libraries

## External

### Threads

set(CMAKE_THREAD_PREFER_PTHREAD TRUE)
set(THREADS_PREFER_PTHREAD_FLAG TRUE)
find_package(Threads)
target_link_libraries(${PROJECT_NAME} PRIVATE Threads::Threads)

### SDL3

find_package(SDL3 REQUIRED CONFIG REQUIRED COMPONENTS SDL3-shared)
target_link_libraries(${PROJECT_NAME} PRIVATE SDL3::SDL3)

## libpng

find_package(PNG REQUIRED)
target_link_libraries(${PROJECT_NAME} PRIVATE PNG::PNG)

## Submodules

### cvc5

find_package(cvc5)

target_link_libraries(${PROJECT_NAME} PRIVATE cvc5::cvc5 cvc5::cvc5parser)

target_include_directories(
    ${PROJECT_NAME}
    PRIVATE
        ${PROJECT_SOURCE_DIR}/cvc5/build/include
        ${PROJECT_SOURCE_DIR}/cvc5/include
)

## FetchContent

include(FetchContent)

### cwalk
FetchContent_Declare(
    cwalk
    GIT_REPOSITORY https://github.com/likle/cwalk.git
    GIT_TAG v1.2.9
)

FetchContent_MakeAvailable(cwalk)
target_include_directories(${PROJECT_NAME} PRIVATE ${cwalk_SOURCE_DIR}/include)
target_sources(${PROJECT_NAME} PRIVATE ${cwalk_SOURCE_DIR}/src/cwalk.c)

### spdlog
FetchContent_Declare(
    stumpless
    GIT_REPOSITORY git@github.com:goatshriek/stumpless.git
    GIT_TAG v2.2.0
)

FetchContent_MakeAvailable(stumpless)
target_link_libraries(${PROJECT_NAME} PRIVATE stumpless)
target_include_directories(
    ${PROJECT_NAME}
    PRIVATE ${stumpless_SOURCE_DIR}/include ${stumpless_BINARY_DIR}/include
)

### whereami
FetchContent_Declare(
    whereami
    GIT_REPOSITORY https://github.com/gpakosz/whereami.git
)

FetchContent_MakeAvailable(whereami)
target_include_directories(${PROJECT_NAME} PRIVATE ${whereami_SOURCE_DIR}/src)
target_sources(${PROJECT_NAME} PRIVATE ${whereami_SOURCE_DIR}/src/whereami.c)
